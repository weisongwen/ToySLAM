<launch>
  <!-- Launch UWB Ray Tracer Node -->
  <node name="RangingRC" pkg="ToySLAM" type="RangingRC" output="screen">
    <!-- Ray tracing parameters -->
    <param name="max_reflections" value="3"/>
    <param name="max_distance" value="200.0"/>
    <param name="min_signal_power" value="-95.0"/>  <!-- More lenient signal threshold -->
    <param name="noise_floor" value="-100.0"/>
    <param name="update_rate" value="10.0"/>
    <param name="fixed_frame" value="map"/>
    
    <!-- Debug mode to print additional information -->
    <param name="debug_mode" value="true"/>
    
    <!-- Visualization parameters with enhanced visibility -->
    <param name="building_alpha" value="0.5"/>  <!-- More transparent buildings -->
    <param name="path_width" value="0.2"/>      <!-- Thicker paths for better visibility -->
    <param name="show_building_faces" value="true"/> <!-- Show building faces -->
    
    <!-- Environment parameters -->
    <param name="road_length" value="150.0"/>
    <param name="road_width" value="8.0"/>
    <param name="sidewalk_width" value="3.0"/>
    <param name="building_spacing" value="5.0"/>
    <param name="building_height_min" value="5.0"/>
    <param name="building_height_max" value="15.0"/>
    <param name="building_width_min" value="10.0"/>
    <param name="building_width_max" value="25.0"/>
    <param name="building_depth_min" value="10.0"/>
    <param name="building_depth_max" value="15.0"/>
    <param name="buildings_per_side" value="6.0"/>
    <param name="beacon_height" value="12.0"/>  <!-- Higher beacons -->
    
    <!-- Beacon parameters -->
    <param name="beacon_range" value="200.0"/>  <!-- Increased range -->
    <param name="beacon_frequency" value="6500.0"/> <!-- 6.5 GHz -->
    <param name="beacon_power" value="20.0"/>  <!-- Higher power for better reflections -->
    
    <!-- Enhanced reflection visibility -->
    <param name="force_reflections" value="true"/>  <!-- Force reflection paths to be shown -->
    <param name="high_contrast_colors" value="true"/>  <!-- Use high contrast colors -->
  </node>
  
  <!-- Add a simple user position controller that moves in a figure-8 pattern -->
  <node name="user_teleop_node" pkg="ToySLAM" type="user_teleop_node" output="screen">
    <param name="path_length" value="80.0"/>
    <param name="path_width" value="6.0"/>
    <param name="z_height" value="1.7"/>
    <param name="speed" value="0.1"/>  <!-- Slower movement for better observation -->
    <param name="update_rate" value="30.0"/>
  </node>
  
  <!-- Launch RViz with configuration -->
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find ToySLAM)/rviz/uwb_ray_tracer.rviz"/>
</launch>